---
nav_title: 値下げ通知
article_title: 値下げ通知
page_order: 3
alias: "/price_drop_notifications/"
description: "この参考記事では、Brazeカタログで値下げ通知を作成する方法について説明する。"
---

# 値下げ通知

> Brazeカタログによる値下げ通知とCanvasを組み合わせることで、商品の価格が下がったことを顧客に通知することができる。顧客が選択したカスタムイベントを実行するたびに、その商品の価格が値下げされたときに通知されるように自動的に購読することができる。

{% alert important %}
カタログの値下げ通知は、現在早期アクセス中である。この早期アクセスへの参加に興味がある場合は、アカウント・マネージャーに連絡しよう。
{% endalert %}

ユーザーがアイテムのカスタムイベントをトリガーすると、自動的にそのアイテムの値下がり通知を受け取るように登録する。商品の価格が在庫ルール（50％以上の下落など）を満たすと、すべての購読者はキャンペーンやキャンバスを通じて通知を受けることができる。ただし、通知を受け取ることができるのは、通知をオプトインしたユーザーのみである。 

## 値下げ通知の仕組み

`product_clicked` イベントなど、購読イベントとして使用するカスタムイベントを設定する。このイベントには、アイテムID（カタログアイテムID）のプロパティが含まれていなければならない。カタログ名を入れることをお勧めするが、これは必須ではない。価格フィールドの名前も指定するが、これは数値データ型でなければならない。選択されたカスタムイベントがユーザーによって実行され、`price_drop` を含む`type` プロパティを持つとき、それはユーザーとそれが発生したカタログアイテムのためのプライスドロップサブスクリプションを作成するために使用することができる。

アイテムが価格ルールを満たす価格変更をした場合、そのアイテムを購読しているすべてのユーザー（購読イベントを行ったユーザー）を検索し、キャンペーンやキャンバスのトリガーに使用できるBrazeカスタムイベントを送信する。

イベントプロパティはユーザーと一緒に送信されるので、送信するキャンペーンやキャンバスにアイテムの詳細をテンプレートすることができる！

## 値下げ通知を設定する

以下の手順に従って、特定のカタログで値下げ通知を設定する。

1. カタログにアクセスし、**「設定」**タブを選択する。<br>
2. **値下げ**トグルを選択する。<br>
3. グローバル・カタログ設定が構成されていない場合、通知のトリガーに使用されるカスタム・イベントとプロパティをセットアップするよう促される：
    <br> ![カタログ設定の引き出し。][2]{: style="max-width:70%;"}
    - **購読のためのカスタムイベント：**カタログ通知をユーザーに購読させるために使用されるBrazeカスタムイベント。このイベントが発生すると、そのイベントを実行したユーザーがサブスクライブされる。
    - **配信停止用のカスタムイベント：**Brazeカスタムイベントは、ユーザーを通知から解除するために使用される。
    - **アイテム ID イベントプロパティ：**サブスクリプションまたはアンサブスクリプションのアイテムを決定するために使用される、上記のカスタムイベントのプロパティ。カスタムイベントのこのプロパティは、カタログに存在するアイテムIDを含むべきである。カスタムイベントは、このアイテムがどのカタログにあるかを指定するために、`catalog_name` プロパティを含まなければならない。
    - **フォールバック・カタログ**カスタムイベントに`catalog_name` プロパティがない場合、サブスクリプションに使用されるカタログ。
    - カスタムイベントのサンプルは次のようになる。
    ```json
    {
        "events": [
            {
                "external_id": "<external_id>",
                "name": "subscription",
                "time": "2024-04-15T19:22:28Z",
                "properties": {
                    "id": "shirt-xl",
                    "catalog_name": "on_sale_products",
                    "type": ["price_drop"]
                }
            }
        ]
    }
    ```
    <br>
4. **保存を**選択し、カタログの**設定**ページに進む。<br>
5. 通知ルールを設定する。選択肢は2つある：
    - **すべての購読ユーザーに通知 "**は、商品の価格が下がったときに、待機しているすべての顧客に通知する。
    - **一定時間ごとに一定数のユーザーに通知する**設定した通知時間ごとに、指定した数の顧客に通知する。Brazeは、通知する顧客がいなくなるまで、または商品の価格が上がるまで、指定された数の顧客に小刻みに通知する。通知速度は、1分あたり10,000ユーザーを超えることはできない。
6. **カタログの価格欄を**設定する。これは、商品の価格を決定するために使用されるカタログフィールドである。数値型でなければならない。<br>
7. **値下げルールを**設定する。これは、通知が送信されるべきかどうかを決定するために使用されるロジックである。価格下落は、価格の変化率、または価格フィールドの変化量として設定することができる。<br>
8. **Save settingsを**選択する。

![値下げ機能がオンになっていることを示すカタログ設定。値下げルールは、元の価格に対して3％の変更である。][1]{:style="max-width:60%;"}

{% alert important %}
これらの設定にある通知ルールは、キャンバスの通知設定（静粛時間など）を置き換えるものではない。
{% endalert %}

## キャンバスで値下げ通知を使う

カタログで値下がり通知を設定した後、これらの通知をキャンバスで使用するには以下の手順に従う。

1. アクションベースのキャンバスを設定する。
2. トリガーとして**Perform Price Drop Eventを**選択する。
3. 価格下落通知のあるカタログ名を選択する。
4. キャンバスの[セットアップを]({{site.baseurl}}/user_guide/engagement_tools/canvas/create_a_canvas/create_a_canvas/)通常通り続ける。

これで、商品の価格が下がったときに顧客に通知される。

### 液体の使用

値下がりしたカタログ商品の詳細をテンプレート化するには、`canvas_entry_properties` リキッドタグを使用して、`item_id` にアクセスすることができる。 

{%raw%}``{{canvas_entry_properties.${catalog_update}.item_id}}``{%endraw%} 、値下がりしたアイテムのIDが返される。{%raw%}``{{canvas_entry_properties.${catalog_update}.previous_value}}``{%endraw%} 、更新前のアイテムの価格値が返され、{%raw%}``{{canvas_entry_properties.${catalog_update}.new_value}}``{%endraw%} 、更新後の新しい価格値が返される。 

このリキッドタグ{%raw%}``{% catalog_items <name_of_your_catalog> {{canvas_entry_properties.${catalog_update}.item_id}} %}}``{%endraw%} をメッセージの先頭で使い、{%raw%}`{{items[0].<field_name>}}`{%endraw%} を使ってメッセージ全体を通してそのアイテムに関するデータにアクセスする。

## 考慮事項

- ユーザーは90日間契約する。アイテムが90日経っても値下がりしない場合、ユーザーはサブスクリプションから外される。
- **Notify all subscribed users**通知ルールを使用する場合、Brazeは10分間で10万人のユーザーに通知する。
- Brazeは1分間に最大10件のアイテム更新を処理する。つまり、1分間に11のアイテムを更新した場合、最初の10アイテムだけが値下げ通知のトリガーとなる。

[1]: {% image_buster /assets/img/price_drop_notifications.png %}
[2]: {% image_buster /assets/img/catalog_settings_drawer.png %}
