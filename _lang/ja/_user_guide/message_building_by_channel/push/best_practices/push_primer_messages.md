---
nav_title: プッシュ・プライマー アプリ内メッセージ
article_title: プッシュ・プライマー アプリ内メッセージ
page_order: 1
page_type: reference
description: "この記事では、プッシュ・プライマー・アプリ内メッセージの前提条件と設定方法について説明する。"
channel: push

---

# アプリ内メッセージをプッシュする

![ストリーミングアプリのアプリ内メッセージをプッシュする。この通知には「Movie Cannonからプッシュ通知を受け取りますか？通知には新作映画やテレビ番組、その他のお知らせが含まれることがあり、いつでもオフにすることができる。"][1]{: style="float:right;max-width:40%;margin-left:15px;border:none;"}

> ユーザーにプッシュ許可を求めるチャンスは一度しかないため、プッシュ登録を最適化することは、プッシュメッセージのリーチを最大化するために極めて重要である。これを実現するには、アプリ内メッセージを使って、ユーザーがオプトインを選択した場合、どのようなメッセージを受け取ることが期待できるかを、ネイティブのプッシュプロンプトを表示する前に説明すればよい。これはプッシュ・プライマーと呼ばれる。

Brazeでアプリ内プッシュプライマーメッセージを作成するには、iOS、Android、Web用のアプリ内メッセージを作成する際に、ボタンオンクリック時の動作「Request Push Permission」を使用する。

## 前提条件

このガイドでは、新しいSDKバージョンでのみサポートされている、ボタンの[クリック時の動作を](#button-actions)使用している。これらのSDKの中には、まだリリースされていないものもある。現在のバージョンを確認するには、以下のリンクを参照のこと：

{% sdk_min_versions swift:5.4.0 android:21.0.0 web:4.0.3 %}

### 開発チームへの注意事項

#### Android

- **アンドロイド12歳以下：**プッシュはデフォルトでオプトインされているため、プッシュ・プライマーの実装は推奨されない。
- **アンドロイド13以上：**テスト中に何度もプロンプトを表示させたい場合は、デバイスの設定でアプリのプッシュを無効にし、再度プロンプトを表示できるようにする。

#### iOS

- iOSプロンプトは、オペレーティングシステムによって強制され、1回のインストー ルにつき1回しか表示できない。
- アプリのプッシュ設定が明示的にオンまたはオフの場合、プロンプトは表示されず、[仮承認の](https://developer.apple.com/documentation/usernotifications/asking_permission_to_use_notifications#3544375)ユーザーにのみ表示される。
  - アプリのプッシュ設定がオンになっている場合、ユーザーはすでにオプトインしているため、Brazeはアプリ内メッセージを表示しない。
  - アプリのプッシュ設定がオフになっている場合は、設定アプリでアプリの通知設定にユーザーを転送する必要がある。

##### 手動でコードを除去する

このチュートリアルを使って設定したアプリ内メッセージは、ユーザーがアプリ内メッセージボタンをクリックすると、ネイティブのプッシュ・プロンプト・コードを自動的に呼び出す。プッシュ通知の許可を2度要求したり、間違ったタイミングで要求したりするのを避けるため、開発者は実装した既存のプッシュ通知統合を修正し、アプリ内メッセージがユーザーに最初に表示されるプッシュ通知プリマーになるようにする必要がある。

開発者は、アプリやサイトのプッシュ通知の実装を見直し、プッシュ許可を要求するようなコードを手動で削除すべきである。例えば、以下のコードへの参照を探し、削除する：

{% tabs %}
{% tab 目標-C %}
```objc
requestAuthorizationWithOptions
```
{% endtab %}
{% tab 速い %}
```swift
requestAuthorization
```
{% endtab %}
{% tab ジャバスクリプト %}
```javascript
braze.requestPushPermission()
// or
appboy.registerAppboyPushMessages()
```
{% endtab %}
{% tab ジャワ %}
```java
android.permission.POST_NOTIFICATIONS
```
{% endtab %}
{% endtabs %}

## ステップ 1:アプリ内メッセージを作成する

\[通常通り、アプリ内メッセージ][2] を作成する。

メッセージの種類とレイアウトを選択する。ユーザーが期待するプッシュ通知の内容を説明するのに十分なスペースを確保するため（そしてボタンが使えるようにするため）、Brazeはフルスクリーンかモーダルメッセージのどちらかを提案する。フルスクリーンのアプリ内メッセージには画像が必要である。 

## ステップ 2:メッセージを構築する

さて、いよいよコピーを加える番だ！プッシュ・プライマーは、ユーザーにプッシュ通知をオンにするよう促すものであることを忘れてはならない。メッセージ本文では、ユーザーがプッシュ通知をオンにすべき理由を強調することをお勧めする。どのような種類の通知を送りたいのか、どのような価値を提供できるのか、具体的に説明すること。

例えば、あるニュースアプリは次のようなプッシュ・プライマーを使うかもしれない：

> 外出先でニュース速報プッシュ通知を有効にして、あなたにとって重要な記事やトピックのアラートを受け取ろう。

ストリーミング・アプリは次のような使い方をするかもしれない：

> Movie Cannonからのプッシュ通知を受け取る？通知には新作映画やテレビ番組、その他のお知らせが含まれることがあり、いつでもオフにすることができる。

ベスト・プラクティスと追加リソースについては、\[カスタム・オプトイン・プロンプトの作成][3] を参照のこと。

## ステップ 3:ボタンの動作を指定する {#button-actions}

アプリ内メッセージにボタンを追加するには、**Button 1と** **Button 2の**テキストフィールドにテキストを追加する。私たちは、「通知を許可する」と「今は許可しない」をスターターボタンとして推奨しているが、割り当て可能なボタンのプロンプトはたくさんある。

ボタンコピーを追加したら、各ボタンのクリック時の動作を指定する：

- **ボタン 1:**メッセージを閉じる」に設定する。これはセカンダリー・ボタン、つまり「今ではない」オプションだ。
- **ボタン2：**これを "Request Push Permission "に設定する。これがプライマリー・ボタン、つまり「通知を許可する」オプションだ。

![][4]

## ステップ 4:スケジュール・デリバリー

プッシュプライマーを適切な時間に送信するように設定するには、アプリ内メッセージをアクションベースのメッセージとしてスケジュールし、トリガーアクションとして**カスタムイベントを実行する**必要がある。

理想的なタイミングはさまざまだが、Brazeは、ユーザーが何らかの[価値の高いアクションを](https://www.braze.com/resources/videos/mapping-high-value-actions)完了するまで待つことを提案している。これは、ユーザーがアプリやサイトに価値を見出し始めていることを示すか、プッシュ通知で対応できる切実なニーズがある場合だ（例えば、ユーザーが注文をした後で、配送追跡情報を提供したい場合など）。こうすることで、プロンプトはあなたのブランドにとってだけでなく、顧客にとっても有益なものとなる。

![][5]

## ステップ 5: 対象ユーザー

プッシュプライマーキャンペーンの目的は、ユーザーにプッシュメッセージのオプトインを促すことなので、すでにオプトインしているユーザーをターゲットにすることは避けたい。そのためには、`Push Subscription Status is not Opted In` にセグメントまたはフィルターを追加する。

そのうえで、どのような追加セグメントが最も適切かを決めることができる。例えば、2回目の購入を完了したユーザー、会員になるためにアカウントを作成したばかりのユーザー、あるいは週に2回以上アプリを訪れるユーザーなどをターゲットにすることができる。これらの重要なセグメントにユーザーをターゲティングすることで、ユーザーがオプトインし、プッシュを有効にする可能性が高まる。

## ステップ 6:コンバージョンイベント

Brazeは、コンバージョンのデフォルト設定を提案しているが、プッシュ・プライマーを取り巻く[コンバージョンイベントを]({{site.baseurl}}/user_guide/engagement_tools/campaigns/building_campaigns/conversion_events/)設定したい場合もあるだろう。

[1]: {% image_buster /assets/img_archive/push_primer_iam.png %}
[2]: {{site.baseurl}}/user_guide/message_building_by_channel/in-app_messages/create/
[3]: {{site.baseurl}}/user_guide/message_building_by_channel/push/best_practices/creating_custom_opt-in_prompts/
[4]: {% image_buster /assets/img_archive/push_primer_button_behavior.png %}
[5]: {% image_buster /assets/img_archive/push_primer_trigger.png %}
