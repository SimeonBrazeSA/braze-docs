---
nav_title: "プッシュ・キャンペーンの詳細設定"
article_title: プッシュ・キャンペーンの詳細設定
page_order: 5
page_layout: reference
description: "この参考記事では、優先度、カスタムURL、配信オプションなど、プッシュキャンペーンの詳細設定をいくつか取り上げている。"
platform: Android
channel:
  - push
tool:
  - Campaigns

---

# 高度なプッシュ・キャンペーン設定

> Brazeダッシュボードから送信されるAndroidとFire OSのプッシュ通知には、多くの高度な設定が用意されている。この記事では、これらの機能とそれらを効果的に使用する方法について説明します。

## 通知 ID {#notification-id}

通知IDは、あなたが選んだメッセージ・カテゴリーの一意な識別子で、そのIDからの最新のメッセージだけを尊重するようにメッセージング・サービスに通知する。通知 ID を設定すると、古くて無関係なメッセージのスタックではなく、最新で関連性の高いメッセージだけを送信できます。

通知IDを割り当てるには、IDを追加したいプッシュの構成ページに移動し、**「設定」**タブを選択する。**Notification ID**セクションに整数を入力する。通知を発行した後にこの通知を更新するには、以前に使用したのと同じIDで別の通知を送信する。

![]({% image_buster /assets/img_archive/notification_ids.png %}){: style="max-width:80%;" }

## タイム・ツー・ライブ（TTL） {#ttl}

time-to-live (TTL)フィールドでは、プッシュ・メッセージング・サービスでメッセージを保存する時間の長さをカスタムで設定できる。Time-to-Liveのデフォルト値は、Firebase Cloud Messaging (FCM)では4週間、Amazon Device Messaging (ADM)では31日である。

例えば、あなたのアプリがゲームで、ユーザーが毎日ゲームをプレイし続ければゲーム内通貨ボーナスを提供するとする。一定の日数を超えたユーザーに、その日数が破られる危険性があることを警告するプッシュを送ることができる。しかし、ユーザーが4週間後、生存期間をデフォルトに設定した状態でゲームアプリにデバイスを再接続した場合、それらのメッセージはメッセージングサービス内ですでに期限切れとなり、配信されないことになる。

## Firebase メッセージング配信の優先順位 {#fcm-priority}

**Firebase Messaging Delivery Priority** フィールドでは、「通常」または「高」のどちらの優先度でプッシュを Firebase Cloud Messaging に送信するかを制御できます。詳しくは[FCMのドキュメントを](https://firebase.google.com/docs/cloud-messaging/concept-options#setting-the-priority-of-a-message)参照のこと。

## 要約テキスト

要約テキストでは、**拡張通知**ビューに追加のテキストを設定できる。要約テキストは、展開されたビューのメッセージ本文の下に表示されます。画像付きの通知のキャプションとしても機能します。

![][9]

画像を含むプッシュ通知の場合、折りたたまれたビューにはメッセージテキストが表示され、通知が展開されると、要約テキストが画像のキャプションとして表示されます。この動作の例として、以下のアニメーションをご覧いただきたい。

![要約 テキスト 行動][15]

## カスタムURI

**カスタム URI** 機能を使用すると、通知がクリックされたときの誘導先 Web URL または Android リソースを指定できます。カスタム URI が指定されていない場合、通知をクリックするとユーザーはアプリに誘導されます。カスタムURIを使えば、アプリ内のディープリンクだけでなく、アプリ外に存在するリソースにもユーザーを誘導することができる。これは、私たちの\[Messaging API][13] ] またはプッシュ・コンポーザーの**設定で**指定できる。

![カスタムURI][12]

## 通知の表示優先度

{% alert important %}
通知の表示優先度設定は、Android O 以降を実行しているデバイスでは使用されなくなりました。新しいデバイスの場合は、[通知チャネル設定](https://developer.android.com/training/notify-user/channels#importance)を使用して優先度を設定します。
{% endalert %}

プッシュ通知の優先度レベルは、通知トレイ内で他の通知と比較して通知がどのように表示されるかに影響します。また、通常のメッセージや優先度の低いメッセージは、バッテリー寿命を延ばすために遅延がわずかに長くなったり、バッチ処理で送信されたりするのに対し、優先度の高いメッセージは常に即座に送信されるため、配信の速度と方法にも影響する可能性があります。

この機能は、メッセージの重要度や一刻を争うかどうかに基づいてメッセージを区別するのに便利だ。たとえば、危険な道路状況についての通知は高い優先順位を受ける良い候補となるだろうし、進行中のセールについての通知は低い優先順位を受けるべきである。ユーザーの受信トレイで常にトップを占めたり、他の活動を邪魔したりすると、悪影響を及ぼす可能性があるからだ。

Android O では、通知の優先度が通知チャネルのプロパティになりました。開発者と協力して設定中にチャネルの優先度を定義し、ダッシュボードを使用して通知音を送信するときに適切なチャネルを選択する必要があります。Android Oより前のバージョンを実行しているデバイスでは、BrazeダッシュボードとMessaging APIを介して、AndroidとFire OS通知の優先レベルを指定することができる。

特定の優先順位で全ユーザーにメッセージを送るには、\[通知チャネル設定][17] （O+デバイスをターゲットにする）]から間接的に優先順位を指定し、ダッシュボードから個々の優先順位を送信する（<Oデバイスをターゲットにする）ことを推奨する。

AndroidまたはFire OSのプッシュ通知で設定できる優先度については、以下の表を参照のこと：

| 優先順位 | 説明| `priority` 値（APIメッセージ用） |
|------|-----------|----------------------------|
| マックス | 緊急または一刻を争うメッセージ。 | `2` |
| 高 | 友人からの新着メッセージなど、重要な連絡。 | `1` |
| デフォルト | 最も多く通知されている。メッセージが他の優先度タイプのどれにも明確に該当しない場合に使用する。 | `0` |
| 低 | ユーザーに知ってもらいたいが、すぐに行動を起こす必要のない情報。 | `-1`|
| 最小 | 文脈や背景に関する情報。 | `-2`|
{: .reset-td-br-1 .reset-td-br-2 .reset-td-br-3}

詳細については、Googleの[Android通知に関する][2]ドキュメントを参照のこと。

## プッシュ・カテゴリー

アンドロイドのプッシュ通知では、通知があらかじめ定義されたカテゴリーに入るかどうかを指定するオプションがある。AndroidシステムUIは、このカテゴリーを使用して、ユーザーの通知トレイのどこに通知を配置するかについて、ランキングやフィルタリングの決定を行うことができる。

![Settings "タブで "Category "を "None "に設定する。][52]

| カテゴリー | 説明 |
|---|-------|
| なし | デフォルトのオプションである。 |
| アラーム | アラームまたはタイマー。 |
| 電話 | 着信通話（音声またはビデオ）または同様の同期通信要求。 |
| メール | 非同期バルクメッセージ（電子メール）。 |
| エラー | バックグラウンド操作または認証ステータスでエラーが発生した。 |
| イベント | カレンダーのイベント。 |
| メッセージ | ダイレクトメッセージ（SMS、インスタントメッセージなど）を受信する。 |
| 進捗状況 | バックグラウンドで長時間実行されている操作の進行状況。 |
| プロモーション | プロモーションまたは広告。 |
| 推薦 | 具体的でタイムリーな、ひとつのことを勧める。 |
| リマインダー | ユーザーがスケジュールしたリマインダー。 |
| サービス | バックグラウンドサービスを実行していることを示す。 |
| ソーシャル | ソーシャルネットワークまたは共有の更新。 |
| ステータス | デバイスやコンテキストの状態に関する継続的な情報。 |
| システム | システムまたはデバイスのステータスが更新される。システム用に予約されている。 |
| 輸送 | 再生用のメディア・トランスポート・コントロール。 |
{: .reset-td-br-1 .reset-td-br-2}

## プッシュの視認性

アンドロイドのプッシュ通知には、ユーザーのロック画面にどのように通知が表示されるかを決めるオプション・フィールドがある。視認性のオプションと説明については、以下の表を参照のこと。

| 視認性 | 説明 |
|---|-----|
| パブリック | ロック画面に通知が表示される |
| プライベート | コンテンツは非表示です」というメッセージで通知が表示される |
| シークレット | ロック画面に通知が表示されない |
{: .reset-td-br-1 .reset-td-br-2}

さらに、Androidユーザーは、端末の通知プライバシー設定を変更することで、プッシュ通知をロック画面に表示する方法を上書きすることができる。この設定は、プッシュ通知からの可視性を上書きする。

![ダッシュボードのプッシュ優先順位は、可視性の設定が有効で、プライベートに設定されている。][53]{: style="float:right;max-width:60%;margin-left:15px;"}

デバイスの通知プライバシー設定が「**すべてのコンテンツを表示**」（デフォルト設定）であれば、可視性にかかわらず、すべての通知がユーザーのロック画面に表示される。同様に、通知のプライバシーが「**通知を表示しない**」に設定されている場合、通知はロック画面に表示されない。可視性は、通知プライバシーが「**機密コンテンツを隠す**」に設定されている場合にのみ効果がある。

Android Lollipop 5.0.0より前の端末では、この可視化は影響しない。つまり、これらの端末ではすべての通知が表示される。

詳しくは\[Androidドキュメント][51] ]を参照のこと。

## 通知音

Android O では、通知音は通知チャネルのプロパティになりました。開発者と協力して設定時にチャネルのサウンドを定義し、通知を送信するときにダッシュボードを使用して適切なチャネルを選択する必要があります。

Android Oより前のバージョンのAndroidを搭載したデバイスでは、Brazeはダッシュボードのコンポーザーから個々のプッシュメッセージのサウンドを設定できる。これを行うには、デバイスのローカルサウンドリソースを指定します (例: `android.resource://com.mycompany.myapp/raw/mysound`)。 

このフィールドで**Defaultを**選択すると、デバイスのデフォルトの通知音が再生される。これは、私たちの\[Messaging API][13] ] またはプッシュ・コンポーザーの**設定で**指定できる。

![][11]

次に、ダッシュボードのプロンプトに完全なサウンドリソースURI（例えば、`android.resource://com.mycompany.myapp/raw/mysound` ）を入力する。

特定のサウンドで全ユーザーにメッセージを送るには、\[通知チャンネル設定][16] （O+デバイスをターゲットにする）]から間接的にサウンドを指定し、ダッシュボードから個々のサウンドを送信する（<Oデバイスをターゲットにする）ことを推奨する。

[2]: http://developer.android.com/design/patterns/notifications.html
[9]: {% image_buster /assets/img_archive/summary_text.png %}
[11]: {% image_buster /assets/img_archive/sound_android.png %}
[12]: {% image_buster /assets/img_archive/deep_link.png %}
[13]: {{site.baseurl}}/api/endpoints/messaging/
[15]: {% image_buster /assets/img_archive/messagesummary.gif %}
[17]: https://developer.android.com/training/notify-user/channels#importance
[16]: https://developer.android.com/training/notify-user/channels
[51]: https://developer.android.com/guide/topics/ui/notifiers/notifications
[52]: {% image_buster /assets/img_archive/braze_category.png %}
[53]: {% image_buster /assets/img_archive/braze_visibility.png %}
